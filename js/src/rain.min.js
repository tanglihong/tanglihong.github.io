
!function(){function a(){new Date;ctx.clearRect(0,0,canvas.width,canvas.height);for(var b=i.length;b--;){var c=i[b];if(c.update(),c.pos.y>=canvas.height){if(h.hasBounce)for(var d=Math.round(4+4*Math.random());d--;)j.push(new n(c.pos.x,canvas.height));i.splice(b,1)}c.draw()}if(h.hasBounce)for(var b=j.length;b--;){var e=j[b];e.update(),e.draw(),e.pos.y>canvas.height&&j.splice(b,1)}if(i.length<h.maxNum&&Math.random()<g)for(var b=0,f=h.numLevel;f>b;b++)i.push(new m);requestAnimFrame(a)}function b(a){h=a,canvas=document.createElement("canvas"),canvas.id=a.id,canvas.setAttribute("style","position:fixed; top: 0; left: 0; z-index: 2222; pointer-events: none;"),ctx=canvas.getContext("2d"),DPR=window.devicePixelRatio,e=canvas.clientWidth*DPR,f=canvas.clientHeight*DPR,canvas.width=window.screen.width,canvas.height=window.screen.height,document.getElementsByTagName("body")[0].appendChild(canvas),g=.4,c()}function c(){"rain"==h.type?(ctx.lineWidth=1*DPR,ctx.strokeStyle="rgba(223,223,223,0.6)",ctx.fillStyle="rgba(223,223,223,0.6)"):(ctx.lineWidth=2*DPR,ctx.strokeStyle="rgba(254,254,254,0.8)",ctx.fillStyle="rgba(254,254,254,0.8)")}var d,e,f,g,h,i=[],j=[],k=.2;window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/30)};var l=function(a,b){this.x=a||0,this.y=b||0};l.prototype.add=function(a){return null!=a.x&&null!=a.y?(this.x+=a.x,this.y+=a.y):(this.x+=a,this.y+=a),this},l.prototype.copy=function(){return new l(this.x,this.y)};var m=function(){var a=2*Math.random();a>1?this.pos=new l(50+Math.random()*canvas.width,-80):this.pos=new l(canvas.width,Math.random()*canvas.height),this.radius=(h.size_range[0]+Math.random()*h.size_range[1])*DPR,this.speed=(h.speed[0]+Math.random()*h.speed[1])*DPR,this.prev=this.pos;var b=.017453293;d=h.wind_direction*b,speed_x=this.speed*Math.cos(d),speed_y=-this.speed*Math.sin(d),this.vel=new l(speed_x,speed_y)};m.prototype.update=function(){this.prev=this.pos.copy(),h.hasGravity&&(this.vel.y+=k),this.pos.add(this.vel)},m.prototype.draw=function(){if(ctx.beginPath(),ctx.moveTo(this.pos.x,this.pos.y),"rain"==h.type){ctx.moveTo(this.prev.x,this.prev.y);var a=Math.abs(this.radius*Math.cos(d)),b=Math.abs(this.radius*Math.sin(d));ctx.bezierCurveTo(this.pos.x+a,this.pos.y+b,this.prev.x+a,this.prev.y+b,this.pos.x,this.pos.y),ctx.stroke()}else ctx.moveTo(this.pos.x,this.pos.y),ctx.arc(this.pos.x,this.pos.y,this.radius,0,2*Math.PI),ctx.fill()};var n=function(a,b){var c=7*Math.random(),d=Math.PI+Math.random()*Math.PI;this.pos=new l(a,b),this.radius=.2+.8*Math.random(),this.vel=new l(Math.cos(d)*c,Math.sin(d)*c)};n.prototype.update=function(){this.vel.y+=k,this.vel.x*=.95,this.vel.y*=.95,this.pos.add(this.vel)},n.prototype.draw=function(){ctx.beginPath(),ctx.arc(this.pos.x,this.pos.y,this.radius*DPR,0,2*Math.PI),ctx.fill()},b({id:"canvas",maxNum:200,numLevel:20,type:Math.random()>0.5?"rain":"snow",speed:[.4,2.5],size_range:[.5,1.5],hasBounce:!0,wind_direction:-105,hasGravity:!0}),a()}();